define(function(require,exports,module){this._table=require("js/base/table"),this.md5=require("js/base/utils/hrymd5"),module.exports={init:function(){clearPageTimer(),$("#coinSelect").on("change",function(){var e=$(this).find("option:selected").val(),t=e.split(",");$("#availableCTC").val(t[1]),$("#frozenCTC").val(t[2]),$("#publicKey").empty().text(t[3]),$("#coinType").val(t[4]),$("#firstHotspan").empty().text(t[1]),$("#coincode1").empty().text(t[4]),$("#coincode2").empty().text(t[4]),$("#coincode3").empty().text(t[4]),$("#coincode4").empty().text(t[4])}),$("#addWaccount").on("click",function(){loadUrl(_ctx+"/user/btc/get")}),$("#inputNumWit").bind("keyup",function(){var e,t,a=$("#firstHotspan").text(),i=$("#inputNumWit").val();if(t="0123456789",parseInt(i)>parseInt(a))return layer.msg("不可大于可提现金额",{icon:2}),!1;if(i.length>0)for(e=0;e<i.length;e++){if(-1==t.indexOf(i.charAt(e)))return layer.msg("金额必须为数字",{icon:2}),!1;var s=1e-4*parseInt(i),n=parseInt(i)-s;$("#divPrompt").empty().html("手续费额"+s+"CTC 实际到币"+n+"CTC")}}),$("#oktx").on("click",function(){var e=$("#coinType").val(),t=$("#withdrawCode").val(),a=$("#accountPassWord").val(),i=$("#currencyType").val(),s=$("#inputNumWit").val();$("#oktx").attr("disabled",!0),$("#withdraw").ajaxSubmit({type:"post",url:_ctx+"/user/publickey/getOrder",dataType:"JSON",data:{coinType:e,withdrawCode:t,accountPassWord:a,currencyType:i,btcNum:s},success:function(e){e.success||layer.msg(e.msg,{icon:2}),$("#oktx").attr("disabled",!1),$("#table").bootstrapTable("refresh")}})});var e={url:_ctx+"/user/publickeylist/list",columns:[{field:"state",checkbox:!0,align:"center",valign:"middle",value:"id",visible:!1,searchable:!1},{title:"id",field:"id",align:"center",visible:!1,sortable:!1,searchable:!1},{title:"订单号",field:"transactionNum",align:"center",visible:!0,sortable:!1,searchable:!0},{title:"数量",field:"transactionMoney",align:"center",visible:!0,sortable:!1,searchable:!0},{title:"手续费",field:"fee",align:"center",visible:!0,sortable:!1,searchable:!0},{title:"数量",field:"transactionMoney",align:"center",visible:!0,sortable:!1,searchable:!0},{title:"时间",field:"created",align:"center",visible:!0,sortable:!1,searchable:!0},{title:"状态",field:"status",align:"center",visible:!0,sortable:!1,searchable:!0,formatter:function(e,t,a){return 1==e?"待审核":2==e?"已完成":3==e?"已否决":void 0}}],queryParams:function(e){return{limit:e.limit,offset:e.offset,sortOrder:e.order,type:$($("#type").find(".selected")[0]).attr("value"),status:$($("#type").find(".selected")[0]).attr("value")}}};_table.initTable($("#table"),e),$("#type").on("click","a",function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),$("#table").bootstrapTable("refresh",null)})},sendsms:function(){$("#sendsmsBtn").on("click",function(){var e=$("#username").val(),t=$("#inputNumWit").val(),a=$("#accountPassWord").val(),i=$("#withdrawCode").val();$(this).attr("disabled","disabled"),$.ajax({type:"post",url:_ctx+"/sms/getWithdrawCoinCode",data:{username:e,accountPassWord:md5.md5(a),inputNumWit:t,withdrawCode:i},cache:!1,dataType:"json",success:function(e){if(e)if(e.success){layer.msg("发送成功",{icon:1});var t=120;window.clearInterval(a);var a=window.setInterval(function(){t-=1,0==t?($("#sendsmsBtn").html("发送验证码"),$("#sendsmsBtn").removeAttr("disabled"),window.clearInterval(a)):$("#sendsmsBtn").html(t+"秒后重新发送")},1e3)}else $("#sendsmsBtn").removeAttr("disabled"),layer.msg(e.msg,{icon:2});else $("#sendsmsBtn").removeAttr("disabled"),layer.msg("发送失败",{icon:2})},error:function(e){}})})}}});