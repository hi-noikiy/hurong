define(function(require,exports,module){function o(o){this.options=o,this.from=this.to=0}function t(o){return!0===o&&(o={}),null==o.gutter&&(o.gutter="CodeMirror-foldgutter"),null==o.indicatorOpen&&(o.indicatorOpen="CodeMirror-foldgutter-open"),null==o.indicatorFolded&&(o.indicatorFolded="CodeMirror-foldgutter-folded"),o}function e(o,t){for(var e=o.findMarks(l(t,0),l(t+1,0)),r=0;r<e.length;++r)if(e[r].__isFold&&e[r].find().from.line==t)return e[r]}function r(o){if("string"==typeof o){var t=document.createElement("div");return t.className=o+" CodeMirror-guttermarker-subtle",t}return o.cloneNode(!0)}function n(o,t,n){var i=o.state.foldGutter.options,f=t,a=o.foldOption(i,"minFoldSize"),d=o.foldOption(i,"rangeFinder");o.eachLine(t,n,function(t){var n=null;if(e(o,f))n=r(i.indicatorFolded);else{var u=l(f,0),c=d&&d(o,u);c&&c.to.line-c.from.line>=a&&(n=r(i.indicatorOpen))}o.setGutterMarker(t,i.gutter,n),++f})}function i(o){var t=o.getViewport(),e=o.state.foldGutter;e&&(o.operation(function(){n(o,t.from,t.to)}),e.from=t.from,e.to=t.to)}function f(o,t,r){var n=o.state.foldGutter;if(n){var i=n.options;if(r==i.gutter){var f=e(o,t);f?f.clear():o.foldCode(l(t,0),i.rangeFinder)}}}function a(o){var t=o.state.foldGutter;if(t){var e=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){i(o)},e.foldOnChangeTimeSpan||600)}}function d(o){var t=o.state.foldGutter;if(t){var e=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var e=o.getViewport();t.from==t.to||e.from-t.to>20||t.from-e.to>20?i(o):o.operation(function(){e.from<t.from&&(n(o,e.from,t.from),t.from=e.from),e.to>t.to&&(n(o,t.to,e.to),t.to=e.to)})},e.updateViewportTimeSpan||400)}}function u(o,t){var e=o.state.foldGutter;if(e){var r=t.line;r>=e.from&&r<e.to&&n(o,r,r+1)}}require("lib/codeonline/lib/codemirror.js"),CodeMirror.defineOption("foldGutter",!1,function(e,r,n){n&&n!=CodeMirror.Init&&(e.clearGutter(e.state.foldGutter.options.gutter),e.state.foldGutter=null,e.off("gutterClick",f),e.off("change",a),e.off("viewportChange",d),e.off("fold",u),e.off("unfold",u),e.off("swapDoc",a)),r&&(e.state.foldGutter=new o(t(r)),i(e),e.on("gutterClick",f),e.on("change",a),e.on("viewportChange",d),e.on("fold",u),e.on("unfold",u),e.on("swapDoc",a))});var l=CodeMirror.Pos});