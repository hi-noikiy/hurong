!function(a){a.fn.calendar=function(t){var e=a.extend({},a.fn.calendar.defaults,t);return this.each(function(){function t(a,t){v.empty(),r(),n(a,t),p(a,t)}function r(){if(0!=y){var t=a('<tr class="week_days" >'),e="";a(u).each(function(a,t){e+="<td",0==a&&(e+=' class="first"'),6==a&&(e+=' class="last"'),e+=">"+t+"</td>"}),e+="</tr>",t.append(e),v.append(t)}}function n(a,t){_.text(h[a]+" "+t);for(var e=1,r=o(1,a,t),n=l(a,t),s=a+1,i="",p=0;7>p;p++){if(r>p){var c="";0==p&&(c+="<tr>"),c+='<td class="invalid',0==p&&(c+=" first"),c+='"></td>'}else{var c="";0==p&&(c+="<tr>"),c+='<td id="'+f+"_"+e+"_"+s+"_"+t+'" ',0==p&&(c+=' class="first"'),6==p&&(c+=' class="last"'),c+="><a>"+e+"</a></span>",6==p&&(c+="</tr>"),e++}i+=c}for(var d=1;n>=e;){var c="";1==d%7&&(c+="<tr>"),c+='<td id="'+f+"_"+e+"_"+s+"_"+t+'" ',1==d%7&&(c+=' class="first"'),0==d%7&&(c+=' class="last"'),c+="><a>"+e+"</a></td>",0==d%7&&(c+="</tr>"),e++,d++,i+=c}if(0!=--d%7){c="";for(var p=d%7+1;7>=p;p++){var c="";c+='<td class="invalid',7==p&&(c+=" last"),c+='"></td>',7==p&&(c+="</tr>"),i+=c}}v.append(i)}function o(a,t,e){return new Date(e,t,a).getDay()}function s(a,t,e){return a>0&&13>a&&e>0&&32768>e&&t>0&&t<=new Date(e,a,0).getDate()}function l(a,t){for(var e=28;s(a+1,e+1,t);)e++;return e}function i(a){var t=a.split("/");return 3==t.length&&s(t[1],t[0],t[2])}function p(t,e){0!=w?a.ajax({type:w.type,url:w.url,data:{month:t+1,year:e},dataType:"json"}).done(function(r){g=[],a.each(r,function(a){g.push(r[a])}),c(t,e)}):c(t,e)}function c(t,e){for(var r=t+1,n=0;n<g.length;n++)g[n][0].split("/")[1]==r&&g[n][0].split("/")[2]==e&&(a("#"+f+"_"+g[n][0].replace(/\//g,"_")).addClass("event"),a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("data-original-title",g[n][1]),g[n][3]&&a("#"+f+"_"+g[n][0].replace(/\//g,"_")).css("background",g[n][3]),""==g[n][2]||"#"==g[n][2]?""!=g[n][4]?(a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("data-trigger","manual"),a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").addClass("manual_popover")):a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("href","javascript:false;"):a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("href",g[n][2]),g[n][4]?(a("#"+f+"_"+g[n][0].replace(/\//g,"_")).addClass("event_popover"),a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("rel","popover"),a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("data-content",g[n][4])):(a("#"+f+"_"+g[n][0].replace(/\//g,"_")).addClass("event_tooltip"),a("#"+f+"_"+g[n][0].replace(/\//g,"_")+" a").attr("rel","tooltip")));a("#"+f+" .event_tooltip a").tooltip(b),a("#"+f+" .event_popover a").popover(m),a(".manual_popover").click(function(){a(this).popover("toggle")})}var d,v,u,_=a('<div class="visualmonthyear"></div>'),f="cal_"+Math.floor(99999*Math.random()).toString(36),g=e.events;u=void 0!==e.days?e.days:["S","M","T","W","T","F","S"];var h;h=void 0!==e.months?e.months:["January","February","March","April","May","June","July","August","September","October","November","December"];var y;y=void 0===e.show_days||e.show_days;var m;m="undefined"!=e.popover_options?e.popover_options:{placement:"top"};var b;b=void 0!==e.tooltip_options?e.tooltip_options:{placement:"top"};var w;w=void 0!==e.req_ajax&&e.req_ajax;var D=a(this);!function(){v=a('<table class="daysmonth table table">'),r();var e=new Date,o=D.val();if(""!=o&&i(o)){var s=o.split("/");2==s[2].length&&("0"==s[2].charAt(0)&&(s[2]=s[2].substring(1)),s[2]=parseInt(s[2]),s[2]<50&&(s[2]+=2e3)),e=new Date(s[2],s[1]-1,s[0])}var l=e.getMonth(),c=e.getFullYear();n(l,c);var u=a('<td><i class="icon-arrow-right"></i></td>');u.click(function(a){a.stopPropagation(),a.preventDefault(),l=(l+1)%12,0==l&&c++,t(l,c)});var g=a('<td><i class="icon-arrow-left"></i></td>');g.click(function(a){a.stopPropagation(),a.preventDefault(),l-=1,-1==l&&(c--,l=11),t(l,c)}),a(".icon-arrow-left").css("cursor","pointer"),a(".icon-arrow-right").css("cursor","pointer");var h=a('<table class="table header"><tr></tr></table>'),y=a('<td colspan=5 class="year span6"></td>');h.append(g),h.append(y),h.append(u),y.append(_),d=a('<div class="calendar" id="'+f+'" ></div>'),d.prepend(h),d.append(v),D.append(d),p(l,c)}()}),this}}(jQuery);