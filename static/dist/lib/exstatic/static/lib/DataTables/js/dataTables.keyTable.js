var KeyTable;!function(e,t,n){var o=function($,n){"use strict";return KeyTable=function(n){function o(e,t,n,o){C[e].push({x:t,y:n,fn:o})}function a(e,t,n,o){for(var a=0,l=0,r=C[e].length;l<r-a;l++)if(void 0!==o)C[e][l-a].x==t&&C[e][l-a].y==n&&C[e][l-a].fn==o&&(C[e].splice(l-a,1),a++);else if(C[e][l-a].x==t&&C[e][l-a].y==n)return C[e].splice(l,1),1;return a}function l(e,t,n){for(var o=0,a=C[e],l=0;l<a.length;l++)(a[l].x==t&&a[l].y==n||null===a[l].x&&a[l].y==n||a[l].x==t&&null===a[l].y||null===a[l].x&&null===a[l].y)&&(a[l].fn(p(t,n),t,n),o++);return o}function r(n,o){if(N!=n){void 0===o&&(o=!0),null!==N&&f(N),$(n).addClass(k),$(n).parent().addClass(k);var a;if(K){a=K;for(var r=h(n)[1],i=_;r>=a.fnDisplayEnd();)a._iDisplayLength>=0?a._iDisplayStart+a._iDisplayLength<a.fnRecordsDisplay()&&(a._iDisplayStart+=a._iDisplayLength):a._iDisplayStart=0,K.oApi._fnCalculateEnd(a);for(;r<a._iDisplayStart;)a._iDisplayStart=a._iDisplayLength>=0?a._iDisplayStart-a._iDisplayLength:0,a._iDisplayStart<0&&(a._iDisplayStart=0),K.oApi._fnCalculateEnd(a);K.oApi._fnDraw(a),_=i}var s=y(n);N=n,S=s[0],x=s[1];var u,d,p,m,g,D,L;if(o&&(u=$(e).height(),d=$(e).width(),p=$(t).scrollTop(),m=$(t).scrollLeft(),g=n.offsetHeight,D=n.offsetWidth,L=T(n),!K||void 0===a.oScroll||""===a.oScroll.sX&&""===a.oScroll.sY||(L[1]-=$(a.nTable.parentNode).scrollTop(),L[0]-=$(a.nTable.parentNode).scrollLeft()),L[1]+g>p+u?b(L[1]+g-u):L[1]<p&&b(L[1]),L[0]+D>m+d?v(L[0]+D-d):L[0]<m&&v(L[0])),K&&void 0!==a.oScroll&&(""!==a.oScroll.sX||""!==a.oScroll.sY)){var C=a.nTable.parentNode;u=C.clientHeight,d=C.clientWidth,p=C.scrollTop,m=C.scrollLeft,g=n.offsetHeight,D=n.offsetWidth,n.offsetTop+g>u+p?C.scrollTop=n.offsetTop+g-u:n.offsetTop<p&&(C.scrollTop=n.offsetTop),n.offsetLeft+D>d+m?C.scrollLeft=n.offsetLeft+D-d:n.offsetLeft<m&&(C.scrollLeft=n.offsetLeft)}c(),l("focus",S,x)}}function i(){f(N),S=null,x=null,N=null,d()}function f(e){$(e).removeClass(k),$(e).parent().removeClass(k),l("blur",S,x)}function s(e){for(var t=this;"TD"!=t.nodeName;)t=t.parentNode;r(t),c()}function u(e){if(L.block||!_)return!0;if(e.metaKey||e.altKey||e.ctrlKey)return!0;var t,n,o,a=D.getElementsByTagName("tr")[0].getElementsByTagName("td").length;if(K){o=K.aiDisplay.length;var f=h(N);if(null===f)return;S=f[0],x=f[1]}else o=D.getElementsByTagName("tr").length;var s=9==e.keyCode&&e.shiftKey?-1:e.keyCode;switch(s){case 13:return e.preventDefault(),e.stopPropagation(),l("action",S,x),!0;case 27:if(!l("esc",S,x))return void i();t=S,n=x;break;case-1:case 37:if(S>0)t=S-1,n=x;else{if(!(x>0))return!(-1!=s||!m)&&(E=!0,g.focus(),setTimeout(function(){E=!1},0),_=!1,i(),!0);t=a-1,n=x-1}break;case 38:if(!(x>0))return!1;t=S,n=x-1;break;case 36:t=S,n=0;break;case 33:t=S,n=x-10,n<0&&(n=0);break;case 9:case 39:if(S<a-1)t=S+1,n=x;else{if(!(x<o-1))return!(9!=s||!m)&&(E=!0,g.focus(),setTimeout(function(){E=!1},0),_=!1,i(),!0);t=0,n=x+1}break;case 40:if(!(x<o-1))return!1;t=S,n=x+1;break;case 35:t=S,n=o-1;break;case 34:t=S,n=x+10,n>o-1&&(n=o-1);break;default:return!0}return r(p(t,n)),!1}function c(){_||(_=!0)}function d(){_=!1}function p(e,t){return K?void 0!==K.aoData[K.aiDisplay[t]]?K.aoData[K.aiDisplay[t]].nTr.getElementsByTagName("td")[e]:null:$("tr:eq("+t+")>td:eq("+e+")",D)[0]}function y(e){return K?[$("td",e.parentNode).index(e),$("tr",e.parentNode.parentNode).index(e.parentNode)+K._iDisplayStart]:[$("td",e.parentNode).index(e),$("tr",e.parentNode.parentNode).index(e.parentNode)]}function b(e){t.documentElement.scrollTop=e,t.body.scrollTop=e}function v(e){t.documentElement.scrollLeft=e,t.body.scrollLeft=e}function T(e){var t=0,n=0;if(e.offsetParent)for(t=e.offsetLeft,n=e.offsetTop,e=e.offsetParent;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return[t,n]}function h(e){for(var t=0,n=K.aiDisplay.length;t<n;t++)for(var o=K.aoData[K.aiDisplay[t]].nTr,a=o.getElementsByTagName("td"),l=0,r=a.length;l<r;l++)if(a[l]==e)return[l,t];return null}this.block=!1,this.event={remove:{}},this.fnGetCurrentPosition=function(){return[S,x]},this.fnGetCurrentData=function(){return N.innerHTML},this.fnGetCurrentTD=function(){return N},this.fnSetPosition=function(e,t){r("object"==typeof e&&e.nodeName?e:p(e,t))},this.fnBlur=function(){i()};var m,g,D=null,N=null,S=null,x=null,L=null,k="focus",_=!1,C={action:[],esc:[],focus:[],blur:[]},K=null,E=!1;for(var j in C)j&&(this.event[j]=function(e){return function(t,n,a){if(null!==t&&"number"!=typeof t||null!==n&&"number"!=typeof n||"function"!=typeof a)if("object"==typeof t&&"function"==typeof n){var l=y(t);o(e,l[0],l[1],n)}else alert("Unhandable event type was added: x"+t+"  y:"+n+"  z:"+a);else o(e,t,n,a)}}(j),this.event.remove[j]=function(e){return function(t,n,o){if(null!==t&&"number"!=typeof arguments[0]||null!==n&&"number"!=typeof arguments[1])if("object"==typeof arguments[0]){var l=y(t);"function"==typeof arguments[1]?a(e,l[0],l[1],n):a(e,l[0],l[1])}else alert("Unhandable event type was removed: x"+t+"  y:"+n+"  z:"+o);else"function"==typeof arguments[2]?a(e,t,n,o):a(e,t,n)}}(j));var w,B;void 0===n?(w=$("table.KeyTable")[0],B=null):$.isPlainObject(n)?(w=n.table,B=n.datatable):(B=new $.fn.dataTable.Api(n).settings()[0],w=B.nTable),function(e,n,o,a){if(L=a,void 0===o&&(o={}),void 0===o.focus&&(o.focus=[0,0]),o.table=e,$(o.table).addClass("KeyTable"),void 0!==o.focusClass&&(k=o.focusClass),void 0!==n&&(K=n),void 0===o.initScroll&&(o.initScroll=!0),void 0===o.form&&(o.form=!1),m=o.form,D=o.table.getElementsByTagName("tbody")[0],m){var l=t.createElement("div");g=t.createElement("input"),l.style.height="1px",l.style.width="0px",l.style.overflow="hidden",void 0!==o.tabIndex&&(g.tabIndex=o.tabIndex),l.appendChild(g),o.table.parentNode.insertBefore(l,o.table.nextSibling),$(g).focus(function(){E||(_=!0,E=!1,void 0!==o.focus.nodeName?r(o.focus,o.initScroll):r(p(o.focus[0],o.focus[1]),o.initScroll),setTimeout(function(){g.blur()},0))}),_=!1}else void 0!==o.focus.nodeName?r(o.focus,o.initScroll):r(p(o.focus[0],o.focus[1]),o.initScroll),c();$(t).bind("keydown",u),K?$(K.nTable).on("click","td",s):$(D).on("click","td",s),$(t).click(function(e){for(var t=e.target,n=!1;t;){if(t==o.table){n=!0;break}t=t.parentNode}n||i()})}(w,B,n,this)},KeyTable.version="1.2.1",$.fn.dataTable.KeyTable=KeyTable,$.fn.DataTable.KeyTable=KeyTable,KeyTable};"function"==typeof define&&define.amd?define(["jquery","datatables"],o):"object"==typeof exports?o(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&o(jQuery,jQuery.fn.dataTable)}(window,document);