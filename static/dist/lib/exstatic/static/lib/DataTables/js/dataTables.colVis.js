!function(t,s,n){var o=function($,t){"use strict";var n=function(t,s){return this.CLASS&&"ColVis"==this.CLASS||alert("Warning: ColVis must be initialised with the keyword 'new'"),void 0===s&&(s={}),$.fn.dataTable.camelToHungarian&&$.fn.dataTable.camelToHungarian(n.defaults,s),this.s={dt:null,oInit:s,hidden:!0,abOriginal:[]},this.dom={wrapper:null,button:null,collection:null,background:null,catcher:null,buttons:[],groupButtons:[],restore:null},n.aInstances.push(this),this.s.dt=$.fn.dataTable.Api?new $.fn.dataTable.Api(t).settings()[0]:t,this._fnConstruct(s),this};return n.prototype={button:function(){return this.dom.wrapper},fnRebuild:function(){this.rebuild()},rebuild:function(){for(var t=this.dom.buttons.length-1;t>=0;t--)this.dom.collection.removeChild(this.dom.buttons[t]);this.dom.buttons.splice(0,this.dom.buttons.length),this.dom.restore&&this.dom.restore.parentNode(this.dom.restore),this._fnAddGroups(),this._fnAddButtons(),this._fnDrawCallback()},_fnConstruct:function(t){this._fnApplyCustomisation(t);var n,o,i=this;for(this.dom.wrapper=s.createElement("div"),this.dom.wrapper.className="ColVis",this.dom.button=$("<button />",{class:this.s.dt.bJUI?"ColVis_Button ColVis_MasterButton ui-button ui-state-default":"ColVis_Button ColVis_MasterButton"}).append("<span>"+this.s.buttonText+"</span>").bind("mouseover"==this.s.activate?"mouseover":"click",function(t){t.preventDefault(),i._fnCollectionShow()}).appendTo(this.dom.wrapper)[0],this.dom.catcher=this._fnDomCatcher(),this.dom.collection=this._fnDomCollection(),this.dom.background=this._fnDomBackground(),this._fnAddGroups(),this._fnAddButtons(),n=0,o=this.s.dt.aoColumns.length;n<o;n++)this.s.abOriginal.push(this.s.dt.aoColumns[n].bVisible);this.s.dt.aoDrawCallback.push({fn:function(){i._fnDrawCallback.call(i)},sName:"ColVis"}),$(this.s.dt.oInstance).bind("column-reorder",function(t,s,e){for(n=0,o=i.s.aiExclude.length;n<o;n++)i.s.aiExclude[n]=e.aiInvertMapping[i.s.aiExclude[n]];var l=i.s.abOriginal.splice(e.iFrom,1)[0];i.s.abOriginal.splice(e.iTo,0,l),i.fnRebuild()}),this._fnDrawCallback()},_fnApplyCustomisation:function(t){$.extend(!0,this.s,n.defaults,t),!this.s.showAll&&this.s.bShowAll&&(this.s.showAll=this.s.sShowAll),!this.s.restore&&this.s.bRestore&&(this.s.restore=this.s.sRestore);var s=this.s.groups,o=this.s.aoGroups;if(s)for(var i=0,e=s.length;i<e;i++)s[i].title&&(o[i].sTitle=s[i].title),s[i].columns&&(o[i].aiColumns=s[i].columns)},_fnDrawCallback:function(){for(var t,s=this.s.dt.aoColumns,n=this.dom.buttons,o=this.s.aoGroups,i=0,e=n.length;i<e;i++)t=n[i],void 0!==t.__columnIdx&&$("input",t).prop("checked",s[t.__columnIdx].bVisible);for(var l=0,a=o.length;l<a;l++)!function(t){for(var n=0,o=t.length;n<o;n++)if(!1===s[t[n]].bVisible)return!1;return!0}(o[l].aiColumns)?!function(t){for(var n=0,o=t.length;n<o;n++)if(!0===s[t[n]].bVisible)return!1;return!0}(o[l].aiColumns)?$("input",this.dom.groupButtons[l]).prop("indeterminate",!0):($("input",this.dom.groupButtons[l]).prop("checked",!1),$("input",this.dom.groupButtons[l]).prop("indeterminate",!1)):($("input",this.dom.groupButtons[l]).prop("checked",!0),$("input",this.dom.groupButtons[l]).prop("indeterminate",!1))},_fnAddGroups:function(){var t;if(void 0!==this.s.aoGroups)for(var s=0,n=this.s.aoGroups.length;s<n;s++)t=this._fnDomGroupButton(s),this.dom.groupButtons.push(t),this.dom.buttons.push(t),this.dom.collection.appendChild(t)},_fnAddButtons:function(){var t,s=this.s.dt.aoColumns;if(-1===$.inArray("all",this.s.aiExclude))for(var n=0,o=s.length;n<o;n++)-1===$.inArray(n,this.s.aiExclude)&&(t=this._fnDomColumnButton(n),t.__columnIdx=n,this.dom.buttons.push(t));"alpha"===this.s.order&&this.dom.buttons.sort(function(t,n){var o=s[t.__columnIdx].sTitle,i=s[n.__columnIdx].sTitle;return o===i?0:o<i?-1:1}),this.s.restore&&(t=this._fnDomRestoreButton(),t.className+=" ColVis_Restore",this.dom.buttons.push(t)),this.s.showAll&&(t=this._fnDomShowXButton(this.s.showAll,!0),t.className+=" ColVis_ShowAll",this.dom.buttons.push(t)),this.s.showNone&&(t=this._fnDomShowXButton(this.s.showNone,!1),t.className+=" ColVis_ShowNone",this.dom.buttons.push(t)),$(this.dom.collection).append(this.dom.buttons)},_fnDomRestoreButton:function(){var t=this,s=this.s.dt;return $('<li class="ColVis_Special '+(s.bJUI?"ui-button ui-state-default":"")+'">'+this.s.restore+"</li>").click(function(s){for(var n=0,o=t.s.abOriginal.length;n<o;n++)t.s.dt.oInstance.fnSetColumnVis(n,t.s.abOriginal[n],!1);t._fnAdjustOpenRows(),t.s.dt.oInstance.fnAdjustColumnSizing(!1),t.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomShowXButton:function(t,s){var n=this,o=this.s.dt;return $('<li class="ColVis_Special '+(o.bJUI?"ui-button ui-state-default":"")+'">'+t+"</li>").click(function(t){for(var o=0,i=n.s.abOriginal.length;o<i;o++)-1===n.s.aiExclude.indexOf(o)&&n.s.dt.oInstance.fnSetColumnVis(o,s,!1);n._fnAdjustOpenRows(),n.s.dt.oInstance.fnAdjustColumnSizing(!1),n.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomGroupButton:function(t){var s=this,n=this.s.dt,o=this.s.aoGroups[t];return $('<li class="ColVis_Special '+(n.bJUI?"ui-button ui-state-default":"")+'"><label><input type="checkbox" /><span>'+o.sTitle+"</span></label></li>").click(function(t){var n=!$("input",this).is(":checked");"li"!==t.target.nodeName.toLowerCase()&&(n=!n);for(var i=0;i<o.aiColumns.length;i++)s.s.dt.oInstance.fnSetColumnVis(o.aiColumns[i],n)})[0]},_fnDomColumnButton:function(t){var s=this,n=this.s.dt.aoColumns[t],o=this.s.dt,i=null===this.s.fnLabel?n.sTitle:this.s.fnLabel(t,n.sTitle,n.nTh);return $("<li "+(o.bJUI?'class="ui-button ui-state-default"':"")+'><label><input type="checkbox" /><span>'+i+"</span></label></li>").click(function(n){var i=!$("input",this).is(":checked");"li"!==n.target.nodeName.toLowerCase()&&(i=!i);var e=$.fn.dataTableExt.iApiIndex;$.fn.dataTableExt.iApiIndex=s._fnDataTablesApiIndex.call(s),o.oFeatures.bServerSide?(s.s.dt.oInstance.fnSetColumnVis(t,i,!1),s.s.dt.oInstance.fnAdjustColumnSizing(!1),""===o.oScroll.sX&&""===o.oScroll.sY||s.s.dt.oInstance.oApi._fnScrollDraw(s.s.dt),s._fnDrawCallback()):s.s.dt.oInstance.fnSetColumnVis(t,i),$.fn.dataTableExt.iApiIndex=e,"input"===n.target.nodeName.toLowerCase()&&null!==s.s.fnStateChange&&s.s.fnStateChange.call(s,t,i)})[0]},_fnDataTablesApiIndex:function(){for(var t=0,s=this.s.dt.oInstance.length;t<s;t++)if(this.s.dt.oInstance[t]==this.s.dt.nTable)return t;return 0},_fnDomCollection:function(){return $("<ul />",{class:this.s.dt.bJUI?"ColVis_collection ui-buttonset ui-buttonset-multi":"ColVis_collection"}).css({display:"none",opacity:0,position:this.s.bCssPosition?"":"absolute"})[0]},_fnDomCatcher:function(){var t=this,n=s.createElement("div");return n.className="ColVis_catcher",$(n).click(function(){t._fnCollectionHide.call(t,null,null)}),n},_fnDomBackground:function(){var t=this,s=$("<div></div>").addClass("ColVis_collectionBackground").css("opacity",0).click(function(){t._fnCollectionHide.call(t,null,null)});return"mouseover"==this.s.activate&&s.mouseover(function(){t.s.overcollection=!1,t._fnCollectionHide.call(t,null,null)}),s[0]},_fnCollectionShow:function(){var t,n=this,o=$(this.dom.button).offset(),i=this.dom.collection,e=this.dom.background,l=parseInt(o.left,10),a=parseInt(o.top+$(this.dom.button).outerHeight(),10);this.s.bCssPosition||(i.style.top=a+"px",i.style.left=l+"px"),$(i).css({display:"block",opacity:0}),e.style.bottom="0px",e.style.right="0px";var u=this.dom.catcher.style;if(u.height=$(this.dom.button).outerHeight()+"px",u.width=$(this.dom.button).outerWidth()+"px",u.top=o.top+"px",u.left=l+"px",s.body.appendChild(e),s.body.appendChild(i),s.body.appendChild(this.dom.catcher),$(i).animate({opacity:1},n.s.iOverlayFade),$(e).animate({opacity:.1},n.s.iOverlayFade,"linear",function(){$.browser&&$.browser.msie&&"6.0"==$.browser.version&&n._fnDrawCallback()}),!this.s.bCssPosition){t="left"==this.s.sAlign?l:l-$(i).outerWidth()+$(this.dom.button).outerWidth(),i.style.left=t+"px";var r=$(i).outerWidth(),d=($(i).outerHeight(),$(s).width());t+r>d&&(i.style.left=d-r+"px")}this.s.hidden=!1},_fnCollectionHide:function(){var t=this;this.s.hidden||null===this.dom.collection||(this.s.hidden=!0,$(this.dom.collection).animate({opacity:0},t.s.iOverlayFade,function(t){this.style.display="none"}),$(this.dom.background).animate({opacity:0},t.s.iOverlayFade,function(n){s.body.removeChild(t.dom.background),s.body.removeChild(t.dom.catcher)}))},_fnAdjustOpenRows:function(){for(var t=this.s.dt.aoOpenRows,s=this.s.dt.oApi._fnVisbleColumns(this.s.dt),n=0,o=t.length;n<o;n++)t[n].nTr.getElementsByTagName("td")[0].colSpan=s}},n.fnRebuild=function(t){var s=null;void 0!==t&&(s=t.fnSettings().nTable);for(var o=0,i=n.aInstances.length;o<i;o++)void 0!==t&&s!=n.aInstances[o].s.dt.nTable||n.aInstances[o].fnRebuild()},n.defaults={active:"click",buttonText:"Show / hide columns",aiExclude:[],bRestore:!1,sRestore:"Restore original",bShowAll:!1,sShowAll:"Show All",sAlign:"left",fnStateChange:null,iOverlayFade:500,fnLabel:null,bCssPosition:!1,aoGroups:[],order:"column"},n.aInstances=[],n.prototype.CLASS="ColVis",n.VERSION="1.1.1",n.prototype.VERSION=n.VERSION,"function"==typeof $.fn.dataTable&&"function"==typeof $.fn.dataTableExt.fnVersionCheck&&$.fn.dataTableExt.fnVersionCheck("1.7.0")?$.fn.dataTableExt.aoFeatures.push({fnInit:function(t){var s=t.oInit;return new n(t,s.colVis||s.oColVis||{}).button()},cFeature:"C",sFeature:"ColVis"}):alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download"),$.fn.dataTable.ColVis=n,$.fn.DataTable.ColVis=n,n};"function"==typeof define&&define.amd?define(["jquery","datatables"],o):"object"==typeof exports?o(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.ColVis&&o(jQuery,jQuery.fn.dataTable)}(window,document);