!function(t){if("undefined"!=typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof module&&module.exports){var $=require("jquery");module.exports=t($)}else window.scrollMonitor=t(jQuery)}(function($){function t(){return window.innerHeight||document.documentElement.clientHeight}function i(){if(exports.viewportTop=c.scrollTop(),exports.viewportBottom=exports.viewportTop+exports.viewportHeight,exports.documentHeight=l.height(),exports.documentHeight!==V){for(I=r.length;I--;)r[I].recalculateLocation();V=exports.documentHeight}}function o(){exports.viewportHeight=t(),i(),s()}function e(){clearTimeout(k),k=setTimeout(o,100)}function s(){for(y=r.length;y--;)r[y].update();for(y=r.length;y--;)r[y].triggerCallbacks()}function h(t,i){function o(t){if(0!==t.length)for(V=t.length;V--;)I=t[V],I.callback.call(e,g),I.isOne&&t.splice(V,1)}var e=this;this.watchItem=t,this.offsets=i?i===+i?{top:i,bottom:i}:$.extend({},v,i):v,this.callbacks={};for(var s=0,h=d.length;s<h;s++)e.callbacks[d[s]]=[];this.locked=!1;var n,c,l,r,V,I;this.triggerCallbacks=function(){switch(this.isInViewport&&!n&&o(this.callbacks[p]),this.isFullyInViewport&&!c&&o(this.callbacks[w]),this.isAboveViewport!==l&&this.isBelowViewport!==r&&(o(this.callbacks[a]),c||this.isFullyInViewport||(o(this.callbacks[w]),o(this.callbacks[f])),n||this.isInViewport||(o(this.callbacks[p]),o(this.callbacks[u]))),!this.isFullyInViewport&&c&&o(this.callbacks[f]),!this.isInViewport&&n&&o(this.callbacks[u]),this.isInViewport!==n&&o(this.callbacks[a]),!0){case n!==this.isInViewport:case c!==this.isFullyInViewport:case l!==this.isAboveViewport:case r!==this.isBelowViewport:o(this.callbacks[b])}n=this.isInViewport,c=this.isFullyInViewport,l=this.isAboveViewport,r=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var t=this.top,i=this.bottom;if(this.watchItem.nodeName){var e=this.watchItem.style.display;"none"===e&&(this.watchItem.style.display="");var s=$(this.watchItem).offset();this.top=s.top,this.bottom=s.top+this.watchItem.offsetHeight,"none"===e&&(this.watchItem.style.display=e)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=exports.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===t&&void 0===i||this.top===t&&this.bottom===i||o(this.callbacks[m])}},this.recalculateLocation(),this.update(),n=this.isInViewport,c=this.isFullyInViewport,l=this.isAboveViewport,r=this.isBelowViewport}function n(t){g=t,i(),s()}var exports={},c=$(window),l=$(document),r=[],a="visibilityChange",p="enterViewport",w="fullyEnterViewport",u="exitViewport",f="partiallyExitViewport",m="locationChange",b="stateChange",d=[a,p,w,u,f,m,b],v={top:0,bottom:0};exports.viewportTop,exports.viewportBottom,exports.documentHeight,exports.viewportHeight=t();var V,g,I,k,y;h.prototype={on:function(t,i,o){switch(!0){case t===a&&!this.isInViewport&&this.isAboveViewport:case t===p&&this.isInViewport:case t===w&&this.isFullyInViewport:case t===u&&this.isAboveViewport&&!this.isInViewport:case t===f&&this.isAboveViewport:if(i(),o)return}if(!this.callbacks[t])throw new Error("Tried to add a scroll monitor listener of type "+t+". Your options are: "+d.join(", "));this.callbacks[t].push({callback:i,isOne:o})},off:function(t,i){if(!this.callbacks[t])throw new Error("Tried to remove a scroll monitor listener of type "+t+". Your options are: "+d.join(", "));for(var o,e=0;o=this.callbacks[t][e];e++)if(o.callback===i){this.callbacks[t].splice(e,1);break}},one:function(t,i){this.on(t,i,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<exports.viewportTop,this.isBelowViewport=this.bottom>exports.viewportBottom,this.isInViewport=this.top<=exports.viewportBottom&&this.bottom>=exports.viewportTop,this.isFullyInViewport=this.top>=exports.viewportTop&&this.bottom<=exports.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=r.indexOf(this),i=this;r.splice(t,1);for(var o=0,e=d.length;o<e;o++)i.callbacks[d[o]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var H=0,B=d.length;H<B;H++){var T=d[H];h.prototype[T]=function(t){return function(i,o){this.on.call(this,t,i,o)}}(T)}try{i()}catch(t){$(i)}return c.on("scroll",n),c.on("resize",e),exports.beget=exports.create=function(t,i){"string"==typeof t&&(t=$(t)[0]),t instanceof $&&(t=t[0]);var o=new h(t,i);return r.push(o),o.update(),o},exports.update=function(){g=null,i(),s()},exports.recalculateLocations=function(){exports.documentHeight=0,exports.update()},exports});