function connect(n){function e(n,e){if(n&&n.msgType){if(Array.prototype.forEach)y[n.msgType]&&Array.prototype.forEach.call(y[n.msgType],function(e,o){e(n)});else if(y[n.msgType]){y[n.msgType].length;for(var o=y[n.msgType],t=0,s=o.length;t<s;t++)o[t](n)}f.LastTime=Math.round((new Date).getTime())}}function o(n){e(n,1)}function t(){if(u){for(var n in a){a[n];m.emit("request",a[n])}u=!1,r=!0}}function s(n){r=!1;try{JSON.stringify(n)}catch(n){}}function i(){if(f.LastTime){var n=Math.round((new Date).getTime()),e=n-f.LastTime;l&&l(e)}else l&&l(Number.MAX_VALUE);setTimeout(i,1e3)}function c(n){return JSON.parse(JSON.stringify(n))}var r,m,f={},y={},a={},u=!0;if((n=n||"http://hq.huobi.com")&&window.socketInstanced&&window.socketInstanced[n])return socketInstanced[n];f.reg=function(n,e){if("object"==typeof n)if(n.symbolList)for(var o in n.symbolList)n.symbolList.hasOwnProperty(o)&&(y[o+n.symbolList[o][0].symbolId]=e);else n.msgType&&(y[n.msgType+n.symbolId]?y[n.msgType+n.symbolId].push(e):y[n.msgType+n.symbolId]=[e]);else y[n]?y[n].push(e):y[n]=[e]},f.help=function(){},f.fnList=y,f.msg=function(n,e){if("unMsg"===e)if(n.symbolList)for(var o in n.symbolList)n.symbolList.hasOwnProperty(o)&&delete a[o+n.symbolList[o][0].symbolId];else delete a[n];else if(n.symbolList)for(var t in n.symbolList)n.symbolList.hasOwnProperty(t)&&(a[t+n.symbolList[t][0].symbolId]=n);else n.msgType&&(a[n.msgType+n.symbolId]=n);r&&m.emit("request",n)},f.clearmsg=function(){a={}};var l;return f.Daemon=function(n){l=n},f.UnMsg=function(n){var e=c(n);e.msgType="reqMsgUnsubscribe",f.msg(e,"unMsg")},function(){m=io.connect(n,{"force new connection":0,"sync disconnect on unload":0,"reconnection delay":1e3,"reconnection delay max":5e3,"max reconnection attempts":999999}),m.on("request",o),m.on("message",e),m.on("connect",t),m.on("error",function(){console.warn("error",arguments)}),m.on("reconnect",function(){r=!0;for(var n in a)m.emit("request",a[n])}),m.on("disconnect",s),window.socketInstanced||(window.socketInstanced={}),window.socketInstanced[n]=f,f.conn=m,i()}(),HBCONN=f,HBCONN.msgList=a,f}"function"==typeof define?define(function(){return connect}):"undefined"!=typeof exports?module.connect=connect:window.connect=connect;