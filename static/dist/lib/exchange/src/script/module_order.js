define(function(require,exports,module){function GetOrder(options,change){var op=options||{},temp=op.temp,wrap=$("#"+op.wrap),coin_type=op.coin_type,is_history=op.is_history,damp=op.damp,delay=0==op.delay?0:3e3,init=0,hash=[0,0],oldId=[0,0],Fn,time=4,type="history";return"10"==is_history&&(type="current"),Fn=new A({url:HRY.host+"/user/entrust/list",refresh:delay,damp:damp,data:{coinCode:coin_type,type:type,offset:0,limit:5}},function(data){var _code=data.code;switch(_code){case"loading":""==wrap.html()&&wrap.html('<tr><td colspan="100" class="align_center p_t_30 no_barder"><i class="icon_loading"></i></td></tr>');break;case"error":wrap.html('<tr><td colspan="100" class="align_center p_t_30 no_barder">'+data.msg+"</td></tr>"),hash=[0,0];break;case"success":if("success"===data.code&&-1==data.data.indexOf("script")&&""!=data.data){var delegation=eval("("+data.data+")"),_h=D.md5(JSON.stringify(delegation));if(20==is_history){if(_h!==hash[1]){for(var _i=0;_i<delegation.length;_i++){var _t=delegation[_i];_t.id>oldId[1]&&init?_t.new_order=1:_t.new_order=0}wrap.html(M(temp,delegation.rows)),hash[1]=_h,init||(oldId[1]=delegation.length>0?1*delegation[0].id:0),init=1}}else time--,0==data.data.total?time<=0&&(Fn.Stop(),console.log("Order Stop"),time=4):time=4,_h!==hash[0]&&(wrap.html(M(temp,delegation.rows)),hash[0]=_h,change&&change())}else data.code&&wrap.html('<tr><td colspan="100" class="align_center p_t_30 no_barder"><i class="icon_info"></i> code:'+data.code+", "+(data.msg?data.msg:"")+"</td></tr>"),hash=[0,0]}})}function GetDetails(e){var t=e||{},a=t.temp,r=$(t.wrap),d=t.coin_type,i=t.id,o=t.type;a&&r&&A({url:"/trade/entrust_detail",data:{coin_type:d,order_id:i,delegation_type:o}},function(e){switch(e.code){case"loading":r.html('<div class="align_center p_t_30 no_barder"><i class="icon_loading"></i>'+e.msg+"</div>");break;case"error":r.html('<div class="align_center p_t_30 no_barder">'+e.msg+"</div>");break;case"success":0===e.data.code?r.html(M(a,e.data)):e.code&&r.html('<tr><td colspan="100" class="align_center p_t_30 no_barder">code:'+e.data.code+","+e.data.msg?e.data.msg:"</td></tr>")}})}function CancelOrder(e,t){var a=e||{},r=(a.coin_type,"object"==typeof a.id?a.id.join(","):a.id);ids=r,A({url:HRY.host+"/user/trades/cancelExEntrust.do",data:{coinCode:CURRENT_SYMBOL,entrustNums:ids},type:"POST"},function(e){switch(e.code){case"loading":case"error":t&&t(e);break;case"success":t&&t(JSON.parse(e.data))}})}function CancelAllOrder(e,t){var a=e||{},r=(a.coin_type,"object"==typeof a.id?a.id.join(","):a.id);ids=r,A({url:HRY.host+HRY.modules.exmain+"entrust/cancelallcoinCodeExEntrust.do",data:{coinCode:CURRENT_SYMBOL,entrustNums:ids},type:"POST"},function(e){switch(e.code){case"loading":case"error":t&&t(e);break;case"success":t&&t(JSON.parse(e.data))}})}var $=require("jquery"),A=require("./module_ajax"),M=require("./module_tmpl"),D=require("./module_md5");exports.GetOrder=GetOrder,exports.GetDetails=GetDetails,exports.CancelOrder=CancelOrder,exports.CancelAllOrder=CancelAllOrder});